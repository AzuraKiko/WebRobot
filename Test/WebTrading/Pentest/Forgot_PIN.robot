*** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/API.robot
Resource    ../../../Page/WebTrading/Pentest/Forgot_PIN.robot

*** Variables ***
${username1}        autotest3@equix.com.au
${username2}        autotest@equix.com.au
${username3}        autotest2@equix.com.au
${password}         Abc@1234

*** Test Cases ***
#PT_LI/LO_0053: Check access to Reset Your PIN screen. Via Setting flow
#    [Tags]      PENTEST
#
#PT_LI/LO_0054: Check access to Reset Your PIN screen. Via NEw CBOE flow
#    [Tags]      PENTEST

PT_LI/LO_0056: Check OK button - ` incorrect password confirmation. Incorrect 1st time
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Get token Admin portal
    Click Forgot PIN
    Input textbox Password to confirm         112222
    Click button OK
    Verify error message Password in Reset PIN screen           Incorrect Password

PT_LI/LO_0058: Check OK button - ` incorrect password confirmation. Incorrect 2nd times
    [Tags]      PENTEST
    Click button OK
    Verify Error Setting        You have tried too many times. Please try again later.
    Verify button OK disable in time       10

PT_LI/LO_0060: Check OK button - ` incorrect password confirmation. Incorrect 3rd times
    [Tags]      PENTEST
    Wait button OK enable
    Click button OK
    Verify Error Setting        You have tried too many times. Please try again later.
    Verify button OK disable in time       20

PT_LI/LO_0062: Check OK button - ` incorrect password confirmation. Incorrect 4th times
    [Tags]      PENTEST
    Wait button OK enable
    Click button OK
    Verify Error Setting        You have tried too many times. Please try again later.
    Verify button OK disable in time       120

PT_LI/LO_0064: Check OK button - ` incorrect password confirmation. Incorrect 5th times
    [Tags]      PENTEST
    Wait button OK enable
    Click button OK
    Verify Error Setting        Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.

PT_LI/LO_0066: Check OK button - ` incorrect password confirmation. Incorrect 6th times
    [Tags]      PENTEST
    Click button OK
    Verify Error Setting        Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    API set status of user     2
    Close Browser

PT_LI/LO_0068: Check case incorrect password with 2 user. From Login screen to Reset PIN screen
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Click Sign In link
    ${number}=      Random number         4
    Input textbox Email in Trading      ${number}${username1}
    Input textbox Password in Trading         112222
    Click button [Sign In]
    Verify error message        Incorrect Password or User Login. Please make sure your details are correct and try again
    Click button [Sign In]
    Verify error message        	You have tried too many times. Please try again later.
    Go To    ${URL}
    Login successful Web Trading      ${username3}            ${password}
    Click Forgot PIN
    Input textbox Password to confirm         112222
    Click button OK
    Verify error message Password in Reset PIN screen           Incorrect Password
    Close Browser

PT_LI/LO_0069: Check case incorrect password with 2 user. At Reset PIN screen
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Click Forgot PIN
    Input textbox Password to confirm         112222
    Click button OK
    Verify error message Password in Reset PIN screen           Incorrect Password
    Click button OK
    Verify Error Setting        You have tried too many times. Please try again later.
    Verify button OK disable in time       10
    Go To    ${URL}
    Login successful Web Trading      ${username3}            ${password}
    Click Forgot PIN
    Input textbox Password to confirm         112222
    Click button OK
    Verify error message Password in Reset PIN screen           Incorrect Password
    Close Browser

PT_LI/LO_0070, 0075: Check OK button - correct password. Incorrect 5th times/ Check UI "Enter Your New" screen. Check default loading
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Click Forgot PIN
    Input textbox Password to confirm        ${password}
    Click button OK
    Verify Enter New PIN screen display
    Verify button [Next] disable
    Verify button [Cancel] enable

PT_LI/LO_0073: Check cancel button. when not count down
    [Tags]      PENTEST
    Click button Cancel
    Verify popup Reset PIN display
    Click button Cancel
    Verify popup Enter PIN display

PT_LI/LO_0074: Check cancel button. When count down
    [Tags]      PENTEST
    Click Forgot PIN
    Input textbox Password to confirm        111111
    Click button OK
    Input textbox Password to confirm        111111
    Click button OK
    Click button Cancel
    Verify popup Enter PIN display
    Close Browser

PT_LI/LO_0077: Check input same old PIN
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Click Forgot PIN
    Input textbox Password to confirm        ${password}
    Click button OK
    Input Confirm PIN menu right    ${pin}
    Verify popup Confirm New PIN display

PT_LI/LO_0078: Check input PIN which different from old PIN
    [Tags]      PENTEST
    Click button [Back]
    Input Confirm PIN menu right    121212
    Verify popup Confirm New PIN display

PT_LI/LO_0079, 0080: Check function in New PIN screen. Check Cancel button/ Check Next Button
    [Tags]      PENTEST
    Click button [Back]
    Click button Cancel
    Verify popup Reset PIN display
    Input textbox Password to confirm        ${password}
    Click button OK
    Input Confirm PIN menu right    ${pin}
    Verify popup Confirm New PIN display
    Click button [Back]
    Verify Enter New PIN screen display
    Click button [Next]
    Verify popup Confirm New PIN display

PT_LI/LO_0081: Check UI "Confirm Your New PIN" screen. Check default loading
    [Tags]      PENTEST
    Verify button [Back] enable
    Verify button [Next] disable

PT_LI/LO_0082: Check Confirm PIN. Check input confirmation PIN different new PIN
    [Tags]      PENTEST
    Input Confirm New PIN    121212
    Verify message error Confirm PIN        PIN did not match. Try again

PT_LI/LO_0083, 0084: Check Confirm PIN. Check input confirmation PIN different new PIN x many times/ Check disapears error msg
    [Tags]      PENTEST
    Input Confirm New PIN    121212
    Verify message error Confirm PIN        PIN did not match. Try again
    Input Confirm New PIN    121212
    Verify message error Confirm PIN        PIN did not match. Try again
    Input Confirm New PIN    121212
    Verify message error Confirm PIN        PIN did not match. Try again

PT_LI/LO_0085: Check Confirm PIN. Check confirm PIN successfully
    [Tags]      PENTEST
    Input Confirm New PIN    ${pin}
    Verify OTP screen display

PT_LI/LO_0086: Check function of "Confirm Your New PIN" screen. Check NExt button
    [Tags]      PENTEST
    Click button [Back]
    Click button [Next]
    Verify OTP screen display

PT_LI/LO_0087: Check UI OPT screen. Check UI default loading
    [Tags]      PENTEST
    Verify button [Back] enable
    Verify button [Send Code] enable
    Verify text placeholder textbox input code      Enter 6 Digit Code
    Verify button [Confirm] disable

PT_LI/LO_0091: Check function. Click on Back button
    [Tags]      PENTEST
    Click button [Back]
    Verify popup Confirm New PIN display

PT_LI/LO_0092: Check function. Click on Send Code button
    [Tags]      PENTEST
    Click button [Done]
#    ddang loi, khi nao fix xong day lene uat thi sua vef click button back
    Verify button [Send Code] disable
    Verify button [Send Code] disable in time      60

PT_LI/LO_0089, 0090: Check validate OPT textbox. Check input special character/ Check input string type
    [Tags]      PENTEST
    Input textbox Enter Code        !@#$%^%
    Verify textbox Enter Code receive characters        ${EMPTY}
    Input textbox Enter Code        ABCdef
    Verify textbox Enter Code receive characters        ${EMPTY}

PT_LI/LO_0097: Check confirm button. Check input incorrect OPT 1st time
    [Tags]      PENTEST
    ${number}=          Random number       6
    Input textbox Enter Code        ${number}
    Click button Confirm
    Verify message Error Code       Incorrect verification code. Please retry again

PT_LI/LO_0099: Check confirm button. Check input incorrect OPT 2nd time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     10
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0107: Check confirm button. Check input incorrect OPT 3rd time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     20
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0109: Check confirm button. Check input incorrect OPT 4th time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     120
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0109: Check confirm button. Check input incorrect OPT 5th time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify message Error Code       Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    API set status of user    2