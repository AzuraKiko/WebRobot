*** Settings ***
Library     SeleniumLibrary
Library     Collections
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/WebTrading/Pentest/Log_out.robot
Resource    ../../../Page/API.robot


*** Test Cases ***
PT_LI/LO_0053: Check default loading
    [Tags]    pentest
    Get token Admin portal
    API set status of user    2
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Verify text placeholder of textbox Email
    Verify text placeholder of textbox Password
    Verify button [Sign In] disable

PT_LI/LO_0054,0055: Check status of Login button
    [Tags]    pentest
    API set status of user    2    eq1735097159725
    Input textbox Email in Trading    ${username}
    Verify button [Sign In] disable
    Clear text into textbox Email
    Input textbox Password in Trading    ${password}
    Verify button [Sign In] disable
    Clear text into textbox Password

PT_LI/LO_0058: Check Prefix side - Check input numberic + special charater
    [Tags]    pentest
    ${number}=    Random number    4
    Input textbox Email in Trading    autotest+${number}@equix.com.au
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again

PT_LI/LO_0057: Check Prefix side - Check distinction between uppercase and lowercase
    [Tags]    pentest
    ${number}=    Random number    4
    Input textbox Email in Trading    autoTEST@equix.com.au
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify login successfully
    Close Browser

PT_LI/LO_0073: Check use username exist on system but not belongs to envir
    [Tags]    pentest
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Input textbox Email in Trading    autotest.mo@equix.com.au
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message
    ...    It looks like you are accessing the wrong environment. Questions or confusions? hello@equix.app, and a team member of us will be happy to help.

PT_LI/LO_0062,0063: Check distinction between lowercase and uppercase
    [Tags]    pentest
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    abc@1234
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close popup Sign In
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ABC@1234
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close Browser

PT_LI/LO_0072: Check use Retail to Login
    [Tags]    pentest
    API set right of user    retail
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again

PT_LI/LO_0079: Check input incorrect email 2 times
    [Tags]    pentest
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message    You have tried too many times. Please try again later.
    Verify button disable in time    10

PT_LI/LO_0081: Check input incorrect password 3 times
    [Tags]    pentest
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Wait button [Sign In] enable
    Click button [Sign In]
    Verify error message    You have tried too many times. Please try again later.
    Verify button disable in time    20

PT_LI/LO_0083: Check input incorrect email 4 times
    [Tags]    pentest
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Wait button [Sign In] enable
    Click button [Sign In]
    Verify error message    You have tried too many times. Please try again later.
    Verify button disable in time    120

PT_LI/LO_0085: Check input incorrect password 5 times
    [Tags]    pentest
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Wait button [Sign In] enable
    Click button [Sign In]
    Verify error message
    ...    Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.

PT_LI/LO_0087: Check input incorrect username or password 5 times after that input correct in 6th
    [Tags]    pentest
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Wait button [Sign In] enable
    Click button [Sign In]
    Verify error message
    ...    Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    Close Browser

PT_LI/LO_0075: Check user's status = ADMIN BLOCKED
    [Tags]    pentest
    API set status of user    4
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Input textbox Email in Trading    ${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message
    ...    Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    Close Browser

PT_LI/LO_0077: Check user's status = SECURITY BLOCKED
    [Tags]    pentest
    API set status of user    5
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Input textbox Email in Trading    ${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message
    ...    Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    Close Browser

PT_LI/LO_0070: Check case login with incorrect password, User is Advisor/Operator
    [Tags]    pentest
    API set status of user    2
    API set right of user    operation
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${number}${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close Browser
    API set right of user    advisor
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${number}${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close Browser

PT_LI/LO_0068: Check case login with incorrect email, User is Advisor/Operator
    [Tags]    pentest
    API set status of user    2
    API set right of user    operation
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close Browser
    API set right of user    advisor
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    ${number}=    Random number    4
    Input textbox Email in Trading    ${number}${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify error message    Incorrect Password or User Login. Please make sure your details are correct and try again
    Close Browser

PT_LI/LO_0064,0066,0067: Check Login sucessfully, User is Advisor/Operator
    [Tags]    pentest
    API set status of user    2
    API set right of user    operation
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Input textbox Email in Trading    ${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify login successfully
    Close Browser
    API set right of user    advisor
    Open Link Page    ${URL}    ${Browser}
    Click Sign In link
    Input textbox Email in Trading    ${username}
    Input textbox Password in Trading    ${password}
    Click button [Sign In]
    Verify login successfully
    Close Browser
