*** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/API.robot
Resource    ../../../Page/WebTrading/Pentest/Create_PIN.robot

*** Variables ***
${username1}        autotest_notsetpin@equix.com.au
${username2}        autotest@equix.com.au
${username3}        autotest2@equix.com.au
${password}         Abc@1234

*** Test Cases ***
PT_LI/LO_0026: Check access Create PIN screen
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username1}            ${password}
    Verify popup Set PIN display

PT_LI/LO_0027, 0029: Create PIN flow - Check validate
    [Tags]      PENTEST
    Input PIN       askfh
    Verify textbox Enter PIN receive        0
    Input PIN       11111
    Verify textbox Enter PIN receive        5
    Verify button [Next] disable

PT_LI/LO_0030, 0031: Create PIN flow - Check NEXT button
    [Tags]      PENTEST
    Input PIN       111111
    Verify popup Confirm PIN display
    Click button [Back]
    Verify button [Next] enable

PT_LI/LO_0033, 0034, 0036: Create PIN flow - Check Confirm PIN screen
    [Tags]      PENTEST
    Click button [Next]
    Verify button [Back] enable
    Input Confirm PIN      111112
    Verify message error Confirm PIN        PIN did not match. Try again
    Verify popup Confirm PIN display
    Close Browser

PT_LI/LO_0037, 0038: Check access Input PIN screen, Check UI
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Verify popup Enter PIN display
    Verify textbox Enter PIN receive        0

PT_LI/LO_0039, 0041: Check validate textbox
    [Tags]      PENTEST
    Input PIN       askfh
    Verify textbox Enter PIN receive        0
    Input PIN       11111
    Verify textbox Enter PIN receive        5

PT_LI/LO_0043: Check input PIN. Check input correct PIN
    [Tags]      PENTEST
    Input PIN       111111
    Verify enter PIN success
    Close Browser

PT_LI/LO_0045: Check input PIN. Input wrong PIN 1 time
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Input PIN       111112
    Verify message error Enter PIN      1 Failed PIN Attempt

PT_LI/LO_0047: Check input PIN. Input wrong PIN 2 times in a row, then correct PIN in 3rd time
    [Tags]      PENTEST
    Input PIN       111112
    sleep    1s
    Verify message error Enter PIN      2 Failed PIN Attempts
    Input PIN       111111
    Verify enter PIN success
    Close Browser

PT_LI/LO_0048: Check input PIN. Input wrong PIN 3 times in a row then re-login
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Input PIN       111112
    Verify message error Enter PIN      1 Failed PIN Attempt
    Input PIN       111112
    sleep       1s
    Verify message error Enter PIN      2 Failed PIN Attempts
    Input PIN       111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0049: Check input PIN. Input wrong PIN 1 time and reload then input wrong 2 times in a row
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Input PIN       111112
    Verify message error Enter PIN      1 Failed PIN Attempt
    Go To    ${URL}
    Login successful Web Trading     ${username2}         ${password}
    Input PIN       111112
    sleep       1s
    Verify message error Enter PIN      2 Failed PIN Attempts
    Input PIN       111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0050: Check input PIN.Input wrong PIN 2 times and reload then input 3rd time is incorrect
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Input PIN       111112
    Verify message error Enter PIN      1 Failed PIN Attempt
    Input PIN       111112
    sleep       1s
    Verify message error Enter PIN      2 Failed PIN Attempts
    Go To    ${URL}
    Login successful Web Trading     ${username2}         ${password}
    Input PIN       111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0051, 0052, 0055: Check Forgot PIn? text/ Check access to Reset Your PIN screen. Via Login flow/ Check UI of "Reset Your PIN"
    [Tags]      PENTEST
    Open Link Page Web Trading      ${Browser}
    Login successful Web Trading      ${username2}            ${password}
    Click Forgot PIN
    Verify popup Reset PIN display
    Verify textbox Password blank
    Verify button Cancel enable
    Verify button OK enable
    Close Browser