*** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/API.robot
Resource    ../../../Page/WebTrading/Pentest/Create_PIN.robot


*** Variables ***
${username1}    autotest_notsetpin@equix.com.au
${username2}    autotest@equix.com.au
${username3}    autotest2@equix.com.au
${password}     Abc@1234
${pin}          111111
${new_pin}      222222


*** Test Cases ***
PT_LI/LO_0026: Check access Create PIN screen
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username1}    ${password}
    Verify popup Set PIN display

PT_LI/LO_0027, 0029: Create PIN flow - Check validate
    [Tags]    pentest
    Input PIN    askfh
    Verify textbox Enter PIN receive    0
    Input PIN    11111
    Verify textbox Enter PIN receive    5
    Verify button [Next] disable

PT_LI/LO_0030, 0031: Create PIN flow - Check NEXT button
    [Tags]    pentest
    Input PIN    111111
    Verify popup Confirm PIN display
    Click button [Back]
    Verify button [Next] enable

PT_LI/LO_0033, 0034, 0036: Create PIN flow - Check Confirm PIN screen
    [Tags]    pentest
    Click button [Next]
    Verify button [Back] enable
    Input Confirm PIN    111112
    Verify message error Confirm PIN    PIN did not match. Try again
    Verify popup Confirm PIN display
    Close Browser

PT_LI/LO_0037, 0038: Check access Input PIN screen, Check UI
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Verify popup Enter PIN display
    Verify textbox Enter PIN receive    0

PT_LI/LO_0039, 0041: Check validate textbox
    [Tags]    pentest
    Input PIN    askfh
    Verify textbox Enter PIN receive    0
    Input PIN    11111
    Verify textbox Enter PIN receive    5

PT_LI/LO_0043: Check input PIN. Check input correct PIN
    [Tags]    pentest
    Input PIN    111111
    Verify enter PIN success
    Close Browser

PT_LI/LO_0045: Check input PIN. Input wrong PIN 1 time
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt

PT_LI/LO_0047: Check input PIN. Input wrong PIN 2 times in a row, then correct PIN in 3rd time
    [Tags]    pentest
    Input PIN    111112
    sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111111
    Verify enter PIN success
    Close Browser

PT_LI/LO_0048: Check input PIN. Input wrong PIN 3 times in a row then re-login
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Input PIN    111112
    sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0049: Check input PIN. Input wrong PIN 1 time and reload then input wrong 2 times in a row
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Go To    ${URL}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0050: Check input PIN.Input wrong PIN 2 times and reload then input 3rd time is incorrect
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Input PIN    111112
    sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Go To    ${URL}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    111112
    Verify popup Logout display
    Close Browser

PT_LI/LO_0051, 0052, 0055: Check Forgot PIn? text/ Check access to Reset Your PIN screen. Via Login flow/ Check UI of "Reset Your PIN"
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Click Forgot PIN
    Verify popup Reset PIN display
    Verify textbox Password blank
    Verify button Cancel enable
    Verify button OK enable
    Close Browser

# New Advanced Test Cases

PT_LI/LO_0060: Check PIN format validation - Special characters
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username1}    ${password}
    Verify PIN format validation    !@#$%^    PIN must contain only numbers

PT_LI/LO_0061: Check PIN format validation - Less than 6 digits
    [Tags]    pentest
    Verify PIN format validation    12345    PIN must be 6 digits

PT_LI/LO_0062: Check PIN format validation - More than 6 digits
    [Tags]    pentest
    Verify PIN format validation    1234567    PIN must be 6 digits

PT_LI/LO_0063: Check PIN strength requirements - Sequential numbers
    [Tags]    pentest
    Verify PIN strength requirements    123456    PIN cannot be sequential numbers

PT_LI/LO_0064: Check PIN strength requirements - Repeating numbers
    [Tags]    pentest
    Verify PIN strength requirements    111111    PIN cannot be repeating numbers

PT_LI/LO_0065: Check PIN strength requirements - Common patterns
    [Tags]    pentest
    Verify PIN strength requirements    121212    PIN cannot be a common pattern

PT_LI/LO_0066: Check network timeout handling
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username1}    ${password}
    Input PIN    ${pin}
    Simulate Network Timeout
    Verify Network Error    Network timeout. Please try again

PT_LI/LO_0067: Check session expiry handling
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username1}    ${password}
    Input PIN    ${pin}
    Simulate Session Expiry
    Verify Session Error    Your session has expired. Please login again

PT_LI/LO_0068: Check concurrent session handling
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username1}    ${password}
    Open Second Session
    Input PIN    ${pin}
    Verify Concurrent Session Error    Another session is active. Please close other sessions first

PT_LI/LO_0069: Check PIN change with same PIN
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    ${pin}
    Input New PIN    ${pin}
    Input Confirm New PIN1    ${pin}
    Verify message error Enter PIN    New PIN cannot be the same as current PIN

PT_LI/LO_0070: Check PIN change with recently used PIN
    [Tags]    pentest
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading    ${username2}    ${password}
    Input PIN    ${pin}
    Input New PIN    ${new_pin}
    Input Confirm New PIN1    ${new_pin}
    Click button [Next]
    Verify message error Enter PIN    PIN cannot be one of your last 3 PINs
