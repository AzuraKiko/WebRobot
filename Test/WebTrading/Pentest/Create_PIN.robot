*** Settings ***
Resource    ../../../Page/WebTrading/Pentest/Create_PIN.robot


*** Variables ***
${new_username}     ${EMPTY}
${new_password}     ${EMPTY}


*** Test Cases ***
# Initial PIN Creation Flow
Check access Create PIN screen
    [Tags]    pentest
    Open Create PIN Popup
    Verify popup Set PIN display

Create PIN flow - Check validate
    [Tags]    pentest
    Input PIN    askfh
    Verify textbox Enter PIN receive    0
    Input PIN    11111
    Verify textbox Enter PIN receive    5
    Verify button [Next] disable

Create PIN flow - Check NEXT button
    [Tags]    pentest
    Input PIN    111111
    Verify popup Confirm PIN display
    Click button [Back]
    Verify button [Next] enable

# PIN Confirmation Flow

Create PIN flow - Check Confirm PIN screen
    [Tags]    pentest
    Click button [Next]
    Verify button [Back] enable
    Verify popup Confirm PIN display
    Input Confirm PIN    111112
    Verify message error Confirm PIN    PIN did not match. Try again
    Sleep    3s
    Input Confirm PIN    111111
    Wait Until Element Is Not Visible    ${popup_Confirm_PIN}    ${time}
    Wait Until Element Is Visible    ${btnOk}    ${time}
    Click To Element    ${btnOk}
    Reload Page
    Verify link [Sign In] display

# PIN Entry After Creation Flow

Check access Input PIN screen, Check UI
    [Tags]    pentest
    Sleep    3s
    Wait Until Element Is Not Visible    ${icon_Loading}    ${time}
    Click Login
    Input Username And password    ${new_username}    ${new_password}
    Click SignIn
    Verify popup Enter PIN display
    Verify textbox Enter PIN receive    0

Check validate textbox
    [Tags]    pentest
    Input PIN    askfh
    Verify textbox Enter PIN receive    0
    Input PIN    11111
    Verify textbox Enter PIN receive    5

# PIN Verification Flow

Check input PIN. Check input correct PIN
    [Tags]    pentest
    Input PIN    111111
    Verify enter PIN success
    Close Browser

Check input PIN. Input wrong PIN 1 time
    [Tags]    pentest
    Login    ${username}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt

Check input PIN. Input wrong PIN 2 times in a row, then correct PIN in 3rd time
    [Tags]    pentest
    Input PIN    111112
    Sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111111
    Verify enter PIN success
    Close Browser

Check input PIN. Input wrong PIN 3 times in a row then re-login
    [Tags]    pentest
    Login    ${username}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Input PIN    111112
    Sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111112
    Verify popup Logout display
    Close Browser

# PIN Attempt Persistence Flow

Check input PIN. Input wrong PIN 1 time and reload then input wrong 2 times in a row
    [Tags]    pentest
    Login    ${username}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Go To    ${URL}
    Wait Until Element Is Visible    ${icon_Max}    ${time}
    Click Login
    Input Username And password    ${username}    ${password}
    Click SignIn
    Input PIN    111112
    Sleep    3s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Input PIN    111112
    Verify popup Logout display
    Close Browser

Check input PIN.Input wrong PIN 2 times and reload then input 3rd time is incorrect
    [Tags]    pentest
    Login    ${username}    ${password}
    Input PIN    111112
    Verify message error Enter PIN    1 Failed PIN Attempt
    Input PIN    111112
    Sleep    1s
    Verify message error Enter PIN    2 Failed PIN Attempts
    Go To    ${URL}
    Wait Until Element Is Visible    ${icon_Max}    ${time}
    Click Login
    Input Username And password    ${username}    ${password}
    Click SignIn
    Input PIN    111112
    Verify popup Logout display
    Close Browser

# Forgot PIN Flow

Check Forgot PIN
    [Tags]    pentest
    Login    ${username}    ${password}
    Click Forgot PIN
    Verify popup Reset PIN display
    Verify textbox Password blank
    Verify button Cancel enable
    Verify button OK disable
    Input textbox Password to confirm    ${password}
    Verify button OK enable
    Click Cancel Button
    Close Browser
