*** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/WebTrading/Pentest/Change_PIN.robot
Resource    ../../../Page/API.robot

*** Variables ***
${username1}        autotest3@equix.com.au
${username2}        autotest@equix.com.au
${username3}        autotest2@equix.com.au
${password}         Abc@1234

*** Test Cases ***
PT_LI/LO_0116: Check access right
    [Tags]      PENTEST
    Login and enter PIN successfully Web Trading      ${username2}        ${password}       ${pin}
    Get token Admin portal
    Click icon Setting
    Click option Change PIN
    Verify popup Enter Current Pin display

PT_LI/LO_0117: Check Input current PIN. Input correct PIN
    [Tags]      PENTEST
    Input Current PIN       ${pin}
    Verify popup New Pin display

PT_LI/LO_0119: Check Input current PIN. Input incorrect PIN - 1st time
    [Tags]      PENTEST
    Click button Back
    Input Current PIN           123456
    Verify message error current Pin        1 Failed PIN Attempt

PT_LI/LO_0121: Check Input current PIN. Input incorrect PIN - 2nd time
    [Tags]      PENTEST
    Input Current PIN           123456
    Verify message error current Pin        2 Failed PIN Attempts

PT_LI/LO_0123: Check Input current PIN. Input incorrect PIN - 3rd time
    [Tags]      PENTEST
    Input Current PIN           123456
    Verify message Confirm Bound        You have been automatically signed out for security reasons
    Click button OK in popup Confirm Bound
    Verify link [Sign In] display
    Close Browser

PT_LI/LO_0125: Check Send Code button
    [Tags]      PENTEST
    Login and enter PIN successfully Web Trading      ${username2}        ${password}       ${pin}
    Click icon Setting
    Click option Change PIN
    Input Current PIN       ${pin}
    Input New PIN       ${pin}
    Input Confirm New PIN1      ${pin}
    Click button [Send Code]
    Wait button [Send Code] disable
    Verify button [Send Code] disable in time       60

PT_LI/LO_0128: Check Confirm button. Input incorrect PIN - 1st time
    [Tags]      PENTEST
    Input textbox Enter Code        123456
    Click button Confirm
    Verify message Error Code       Incorrect verification code. Please retry again

PT_LI/LO_0130: Check Confirm button. Input incorrect PIN - 2nd time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     10
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0132: Check Confirm button. Input incorrect PIN - 3rd time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     20
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0134: Check Confirm button. Input incorrect PIN - 4th time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify button [Confirm] disable in time     120
    Verify message Error Code       You have tried too many times. Please try again later.

PT_LI/LO_0136: Check Confirm button. Input incorrect PIN - 5th time
    [Tags]      PENTEST
    Wait button [Confirm] enable
    Click button Confirm
    Verify message Error Code       Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    API set status of user    2
