 *** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/WebTrading/Pentest/Change_Pass.robot
Resource    ../../../Page/WebTrading/Pentest/Change_PIN.robot
Resource    ../../../Page/API.robot

*** Variables ***
${username1}        autotest3@equix.com.au
${username2}        autotest@equix.com.au
${password}         Abc@1234

*** Test Cases ***
PW_046, 047, 048, 049, 050, 051, 052: Check Change Password screen
    [Tags]      PENTEST
    Login and enter PIN successfully Web Trading      ${username2}        ${password}       ${pin}
    Get token Admin portal
    Click icon Setting
    Click option Change Pass
    Verify popup Change Pass display
    Verify text placeholder of textbox Current Password         Current Password
    Verify text placeholder of textbox New Password             New Password
    Verify text placeholder of textbox Confirm New Password         Confirm New Password
    Verify button [OK] in Change Pass screen disable
    Input textbox Current Password              abc
    Input textbox New Password                  abc
    Input textbox Confirm New Password          abc
    Verify button [OK] in Change Pass screen enable
    Verify button [Cancel] in Change Pass screen enable

PW_053: Check Current Password. Check input Current Password (wrong 1st time)
    [Tags]      PENTEST
    Input textbox Current Password              abc@123
    Input textbox New Password                  Abc@12345
    Input textbox Confirm New Password          Abc@12345
    Click button [OK]
    Verify error message at Change Pass         Incorrect Password

PW_054: Check Current Password. Check input Current Password (wrong 2nd time)
    [Tags]      PENTEST
    Click button [OK]
    Verify error message at Change Pass         You have tried too many times. Please try again later.
    Verify button [OK] in Change Pass disable in time     10

PW_055: Check Current Password. Check input Current Password (wrong 3rd time)
    [Tags]      PENTEST
    Click button [OK]
    Verify error message at Change Pass         You have tried too many times. Please try again later.
    Verify button [OK] in Change Pass disable in time      20

PW_056: Check Current Password. Check input Current Password (wrong 4th time)
    [Tags]      PENTEST
    Click button [OK]
    Verify error message at Change Pass         You have tried too many times. Please try again later.
    Verify button [OK] in Change Pass disable in time      120

PW_057: Check Current Password. Check input Current Password (wrong 5th time and more)
    [Tags]      PENTEST
    Click button [OK]
    Verify message Confirm Bound         You have been automatically signed out for security reasons
    API set status of user    2
    Close Browser

PW_058: Check New Password & Confirm New Password. Check New Password don't match Confirm New Password
    [Tags]      PENTEST
    Login and enter PIN successfully Web Trading      ${username2}        ${password}       ${pin}
    Click icon Setting
    Click option Change Pass
    Input textbox Current Password              ${password}
    Input textbox New Password                  aBC@1235
    Input textbox Confirm New Password          aBC@1234
    Click button [OK]
    Verify error message at Change Pass         Those passwords didn't match. Try again.

PW_059, 060, 061, 062, 063, 064: Check New Password & Confirm New Password. Check New Password, Confirm New Password invalid
    [Tags]      PENTEST
    Input textbox New Password                  aBC@12
    Input textbox Confirm New Password          aBC@12
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.
    Input textbox New Password                  ajhdshgfjlkbohkgfblvlkjjkcnjkfgljkkb;ghl;lvfjdkcvgjgvhjhvflbjdb;vgklhgkfljgkilvhsdukfdhgvgjgndkvbnjgbgngjgkfdjkhcffhdfgdhgdfgfghfhdjdfbfjdjdjsskafhkncbsgsgajajsjfbsgwjwhwbdfudjedhjqiaodkfjfbdgdeuweejdkdjddshsyeyehfhvhcgsshndnhfdhdhdhdhdhdffhufffhjfjkdsudsd
    Input textbox Confirm New Password          ajhdshgfjlkbohkgfblvlkjjkcnjkfgljkkb;ghl;lvfjdkcvgjgvhjhvflbjdb;vgklhgkfljgkilvhsdukfdhgvgjgndkvbnjgbgngjgkfdjkhcffhdfgdhgdfgfghfhdjdfbfjdjdjsskafhkncbsgsgajajsjfbsgwjwhwbdfudjedhjqiaodkfjfbdgdeuweejdkdjddshsyeyehfhvhcgsshndnhfdhdhdhdhdhdffhufffhjfjkdsudsd
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.
    Input textbox New Password                  aBC123452
    Input textbox Confirm New Password          aBC123452
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.
    Input textbox New Password                  abc123452
    Input textbox Confirm New Password          abc123452
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.
    Input textbox New Password                  ABC123452
    Input textbox Confirm New Password          ABC123452
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.
    Input textbox New Password                  aBCEFGHac
    Input textbox Confirm New Password          aBCEFGHac
    Click button [OK]
    Verify error message at Change Pass         Your password must include 8-255 characters and contain at least one special character, one lowercase, one capital letter and one number.

PW_065, 066: Check New Password & Confirm New Password. Check New Password, Confirm New Password valid
    [Tags]      PENTEST
    Input textbox New Password                  ${password}
    Input textbox Confirm New Password          ${password}
    Click button [OK]
    Verify error message at Change Pass             New password needs to be different from three latest ones

PW_067: Check wrong 3 fields password
    [Tags]      PENTEST
    Input textbox Current Password              abc@1234
    Input textbox New Password                  Abc@12345
    Input textbox Confirm New Password          Abc@12346
    Click button [OK]
    Verify error message at Change Pass             Those passwords didn't match. Try again.