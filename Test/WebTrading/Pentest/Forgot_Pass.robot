*** Settings ***
Resource    ../../../Page/WebTrading/LoginPage.robot
Resource    ../../../Page/WebTrading/Pentest/Forgot_Pass.robot
Resource    ../../../Page/WebTrading/Pentest/Forgot_PIN.robot
Resource    ../../../Page/API.robot

*** Variables ***
${username1}        autotest@equix.com.au
${password}         Abc@1234

*** Test Cases ***
PW_016: Check Forgot Password screen. Check open Forgot Password screen
    [Tags]      PENTEST
    Open Link Page Web Trading    ${Browser}
    Click Sign In link
    Click link Forgot Password
    Verify popup Forgot Password display

PW_017, 018, 019, 020, 021, 022, 023, 024, 025: Check Forgot Password screen. Check Email field
    [Tags]      PENTEST
    Verify placeholder of textbox Email
    Click header
    Verify mess require Email           Email is required
    Close Browser

PW_019, 020, 022: Check Forgot Password screen. Check Send Code button
    [Tags]      PENTEST
    Open Link Page Web Trading    ${Browser}
    Click Sign In link
    Click link Forgot Password
    Verify button [Send code] in Popup Forgot Pass disable
    Input textbox Email in Popup Forgot Pass        ${username1}
    Verify button [Send code] in Popup Forgot Pass enable
    Click button [Send Code] in Popup Forgot Pass
    Verify button [Send Code] in Popup Forgot Pass disable in time          60
    Verify button [Send code] in Popup Forgot Pass disable
    Input textbox Email in Popup Forgot Pass            abc
    Wait button [Send Code] in Forgot Pass enable
    Click button [Send Code] in Popup Forgot Pass
    Verify error message in popup Forgot Pass       Sorry, an unknown error has occurred. Please contact EQUIX Support.

PW_023, 024: Check Forgot Password screen. Check Enter 6 Digit Code
    [Tags]      PENTEST
    Verify placeholder of textbox Enter Code
    Click textbox [Enter Code] in Popup Forgot Pass
    Click header
    Verify mess require Code        Enter 6 digit code is required

PW_025: Check Forgot Password screen. Check Confirm button
    [Tags]      PENTEST
    Verify button [Confirm] in Popup Forgot Pass disable
    Input textbox Enter Code        123456
    Verify button [Confirm] in Popup Forgot Pass enable
    Close Browser

PW_027: Check Input incorrect code. wrong 1st time
    [Tags]      PENTEST
    Open Link Page Web Trading    ${Browser}
    Click Sign In link
    Click link Forgot Password
    Input textbox Enter Code        123456
    Input textbox Email in Popup Forgot Pass            ${username1}
    Click button [Confirm] in Popup Forgot Pass
    Verify error message in popup Forgot Pass           Incorrect verification code. Please retry again

PW_028: Check Input incorrect code. wrong 2nd time
    [Tags]      PENTEST
    Click button [Confirm] in Popup Forgot Pass
    Verify error message in popup Forgot Pass           You have tried too many times. Please try again later.
    Verify button [Confirm] in Popup Forgot Pass disable in time        10

PW_029: Check Input incorrect code. wrong 3rd time
    [Tags]      PENTEST
    Wait button [Confirm] in Forgot Pass enable
    Click button [Confirm] in Popup Forgot Pass
    Verify error message in popup Forgot Pass           You have tried too many times. Please try again later.
    Verify button [Confirm] in Popup Forgot Pass disable in time        20

PW_030: Check Input incorrect code. wrong 4th time
    [Tags]      PENTEST
    Wait button [Confirm] in Forgot Pass enable
    Click button [Confirm] in Popup Forgot Pass
    Verify error message in popup Forgot Pass           You have tried too many times. Please try again later.
    Verify button [Confirm] in Popup Forgot Pass disable in time        120

PW_031: Check Input incorrect code. wrong 5th time or more
    [Tags]      PENTEST
    Wait button [Confirm] in Forgot Pass enable
    Click button [Confirm] in Popup Forgot Pass
    Verify error message in popup Forgot Pass           Your username has been temporarily blocked for security reason. Please contact hello@equix.app for support.
    Get token Admin portal
    API set status of user    2