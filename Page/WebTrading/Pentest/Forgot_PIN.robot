*** Settings ***
Resource    ../../../Page/WebTrading/Pentest/Create_PIN.robot


*** Variables ***
${textbox_Confirm_New_Pin}      (//*[@class="pinFormInput"])[3]//*[contains(@class,"symbolPrivatePinCode")]
${mess_Erros_Pass}              //*[@class="incorrectText text-capitalize"]
${error_Setting}                //*[@class="errorSetting error"]
${popup_OTP}                    //*[@class="header size--4"][text()='Confirm OTP']
${keyBoardDel1}                 (//*[@fill="var(--secondary-default)"]/ancestor::div[contains(@class, 'btnNumKeyBoard')])[2]


*** Keywords ***
Open Forgot PIN Popup
    [Arguments]    ${username}    ${password}
    Login    ${username}    ${password}
    Click Forgot PIN

Verify error message Password in Reset PIN screen
    [Arguments]    ${text_Expected}
    Wait Until Element Is Visible    ${mess_Erros_Pass}
    FOR    ${i}    IN RANGE    1000
        ${text_Actual}=    Get Text    ${mess_Erros_Pass}
        ${text_Actual}=    Convert To Lowercase    ${text_Actual}
        ${text_Expected}=    Convert To Lowercase    ${text_Expected}
        IF    '${text_Actual}'=='${text_Expected}'    BREAK
    END
    Should Be Equal    ${text_Actual}    ${text_Expected}

Verify Error Setting
    [Arguments]    ${text_Expected}
    Verify message    ${error_Setting}    ${text_Expected}

Wait button OK enable
    Wait Button Enable By Text    ${button_OK}    OK

Verify OK Button Disabled With Time
    [Documentation]    Verifies OK button is disabled with a specific timeout
    [Arguments]    ${time_block}
    ${actual_time}=    Get Text    ${button_OK}
    Should Be Equal    ${time_block}    ${actual_time}

Clear PIN Field Of Forgot PIN Screen
    # Count elements with the specified XPath
    ${elements}=    Get WebElements    ${textbox_Enter_Current_PIN}
    ${length}=    Get Length    ${elements}

    # Only clear if there are elements to clear
    IF    ${length} > 0
        FOR    ${i}    IN RANGE    ${length}
            Click Element    ${keyBoardDel1}
        END
    END

Input New PIN Of Forgot PIN Screen
    [Arguments]    ${pin}
    Wait Until Element Is Visible    ${textbox_Enter_New_PIN}    ${time}
    Clear PIN Field Of Forgot PIN Screen
    Press Keys    ${None}    ${pin}

Input Confirm New PIN Of Forgot PIN Screen
    [Arguments]    ${pin}
    Wait Until Element Is Visible    ${textbox_Enter_Confirm_New_PIN}    ${time}
    Clear PIN Field Of Forgot PIN Screen
    Press Keys    ${None}    ${pin}

Verify OTP screen display
    Verify element display    ${popup_OTP}

Verify textbox Enter Code receive characters
    [Arguments]    ${text_Expected}
    Verify Textbox Allow Characters    ${textbox_Enter_Code}    ${text_Expected}

Verify placeholder of textbox Enter Code
    Verify text placeholder    ${textbox_Enter_Code}    Enter 6 Digit Code

Verify [Send Code] Button Disabled With Time
    [Documentation]    Verifies OK button is disabled with a specific timeout
    [Arguments]    ${time_block}
    Wait Until Element Is Visible    ${button_Send_Code}    ${time}
    FOR    ${i}    IN RANGE    1000
        ${actual_time}=    Get Text    ${button_Send_Code}
        IF    '${actual_time}'=='${time_block}'    BREAK
        Sleep    1s
    END
    Should Be Equal    ${time_block}    ${actual_time}    END
