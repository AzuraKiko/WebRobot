*** Settings ***
Resource    ../../../Locator/LoginLocator.robot
Resource    ../../../Utils/CommonKeyword.robot


*** Variables ***
# Change Password Form Elements
${option_change_password}                                                                           //*[text()='change password']
${header_change_password}                                                                           //*[text()="change your password"]
${textbox_current_password}                                                                         //*[text()='current password']
${textbox_current_password_input}                                                                   //*[text()='current password']//preceding-sibling::input
${textbox_new_password}                                                                             //*[text()='new password']
${textbox_new_password_input}                                                                       //*[text()='new password']//preceding-sibling::input
${textbox_confirm_password}                                                                         //*[text()='confirm new password']
${textbox_confirm_password_input} //*[text()='confirm new password']//preceding-sibling::input      ${EMPTY}

# Button Elements
${button_ok}                                                                                        (//*[text()='cancel']//parent::div//following-sibling::div)[2]
${button_cancel}                                                                                    //*[text()='cancel'][@class="changepasswordText size--4 text-uppercase"]

# Message Elements
${error_message}                                                                                    //*[@class="changepasswordError size--3"]
${loading_icon}                                                                                     //*[@src="common/Spinner-white.svg"]


*** Keywords ***
# Navigation Keywords
Click Change Password Option
    [Documentation]    Clicks the change password option in the menu
    Click To Element    ${option_change_password}

# Verification Keywords

Verify Change Password Popup Displayed
    [Documentation]    Verifies that the change password popup is displayed
    Verify element display    ${header_change_password}

Verify OK Button Disabled
    [Documentation]    Verifies that the OK button is disabled
    Verify button disable/enable by JS    ${button_ok}    not-allowed

Verify OK Button Enabled
    [Documentation]    Verifies that the OK button is enabled
    Verify button disable/enable by JS    ${button_ok}    pointer

Verify Cancel Button Enabled
    [Documentation]    Verifies that the Cancel button is enabled
    Verify button disable/enable by JS    ${button_cancel}    pointer

# Input Keywords

Input Current Password
    [Documentation]    Inputs text into the current password field
    [Arguments]    ${text}
    Input Text To Element    ${textbox_current_password_input}    ${text}

Input New Password
    [Documentation]    Inputs text into the new password field
    [Arguments]    ${text}
    Input Text To Element    ${textbox_new_password_input}    ${text}

Input Confirm Password
    [Documentation]    Inputs text into the confirm password field
    [Arguments]    ${text}
    Input Text To Element    ${textbox_confirm_password_input}    ${text}

# Action Keywords

Click OK Button
    [Documentation]    Clicks the OK button
    Click To Element    ${button_ok}

Verify Error Message
    [Documentation]    Verifies the error message displayed
    [Arguments]    ${expected_text}
    Verify message    ${error_message}    ${expected_text}

Verify OK Button Disabled With Timeout
    [Documentation]    Verifies OK button is disabled with a specific timeout
    [Arguments]    ${timeout}
    Wait Until Element Is Not Visible    ${loading_icon}    timeout=30s
    Verify button disable/enable by JS    ${button_ok}    not-allowed
    ${actual_time}=    Get Text    ${button_ok}
    Should Be Equal    ${timeout}S    ${actual_time}
    Wait button enable by JS    ${button_ok}
