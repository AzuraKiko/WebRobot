*** Settings ***
#Resource        ../../../Locator/LoginLocator.robot
Resource        ../../../Utils/Common.robot
Resource        ../../../Page/WebTrading/Pentest/Create_PIN.robot
Resource        ../../../Page/WebTrading/Pentest/Forgot_PIN.robot
Resource        ../../WebAdmin/Pentest/Change_PIN.robot

*** Variables ***
${icon_Setting}                         //*[@class="headerRight"]//div[text()='settings']
${option_Security}                      //*[@class='myRow  security security']//div[@class='mainRow  active']
${option_ChangePin}                     //*[text()='Change PIN']
${header_Enter_Current_Pin}             //*[@class="header size--4"][text()='Enter Your Current PIN']
${button_OK}                            //span[contains(text(),'ok')]
${textbox_Enter_Current_PIN}            (//*[@class="pinFormInput"])[1]//*[contains(@class,"symbolPrivatePinCode")]
${popup_Enter_New_PIN}                  //*[@class="header size--4"][text()='Enter Your New PIN']
${button_Back}                          //*[@class="button match undefined"][text()='back']
${error_Curren_PIN}                     (//*[contains(@class,"pinFormAlert size--3 ")])[1]
${link_Sign_In}                       //*[@class="loginBtnHeader showTitle text-capitalize"]
${textbox_Enter_New_PIN}                (//*[@class="pinFormInput"])[2]//*[contains(@class,"symbolPrivatePinCode")]

*** Keywords ***
Click icon Setting
    Click To Element    ${icon_Setting}

Click option Security
    Click To Element    ${option_Security}

Click option Change PIN
    Click To Element    ${option_ChangePin}
    
Verify popup Enter Current Pin display
    Verify element display      ${header_Enter_Current_Pin}

Verify popup New Pin display
    Wait Until Element Is Visible    ${popup_Enter_New_PIN}
    Element Should Be Visible    ${popup_Enter_New_PIN}

Login and enter PIN successfully Web Trading
    [Arguments]      ${username}         ${password}      ${pin}
    Open Link Page Web Trading    ${Browser}
    Login successful Web Trading      ${username}            ${password}
    Enter PIN       ${pin}
    Verify enter PIN success
    Click To Element    ${button_OK}

Input Current PIN
    [Arguments]     ${character}
    Wait Until Element Is Visible    ${textbox_Enter_Current_PIN}    20s
    sleep  1s
    FOR    ${i}    IN RANGE    0    6
        Click To Element    ${key_Delete_New_Pin}
    END
    Press Keys    ${None}    ${character}

Input New PIN
    [Arguments]     ${character}
    Wait Until Element Is Visible    ${textbox_Enter_New_PIN}    20s
    sleep  1s
    FOR    ${i}    IN RANGE    0    6
        Click To Element    ${key_Delete_New_Pin}
    END
    Press Keys    ${None}    ${character}

Click button Back
    Click To Element        ${button_Back}

Click button OK in popup Confirm Bound
    Click To Element        ${button_OK}

Verify message error current Pin
    [Arguments]      ${text_Expected}
    Wait Until Element Is Visible    ${error_Curren_PIN}     timeout=30s
    sleep     1s
    ${text_Actual}=         Get Text        ${error_Curren_PIN}
    Should Be Equal         ${text_Expected}     ${text_Actual}

Verify link [Sign In] display
    Verify element display      ${link_Sign_In}

Click button [Send Code]
    Click To Element       ${button_Send_Code}

Wait button [Send Code] disable
    Wait button disable by JS     ${button_Send_Code}