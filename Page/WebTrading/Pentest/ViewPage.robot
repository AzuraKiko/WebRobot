*** Settings ***
Library     SeleniumLibrary
Resource    ../../../Page/WebTrading/Pentest/LoginPage.robot
Resource    ../../../Locator/ViewLocator.robot


*** Keywords ***
# ===== Navigation Keywords =====

View Profile
    [Documentation]    Navigates to company profile view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Fundamentals}
    Click To Element    ${btnMenu_Fundamentals_Profile}

View Statistics
    [Documentation]    Navigates to company statistics view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Fundamentals}
    Click To Element    ${btnMenu_Fundamentals_Statistics}

View Analysis
    [Documentation]    Navigates to company analysis view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Fundamentals}
    Click To Element    ${btnMenu_Fundamentals_Analysis}

View Holders
    [Documentation]    Navigates to company holders view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Fundamentals}
    Click To Element    ${btnMenu_Fundamentals_Holders}

View Market Overview
    [Documentation]    Navigates to market overview view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_MarketOverview}

View Chart
    [Documentation]    Navigates to chart view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_Chart}

View Alert
    [Documentation]    Navigates to alert view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_Alert}

View Derivatives
    [Documentation]    Navigates to derivatives view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_Derivatives}

View Market News
    [Documentation]    Navigates to market news view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_News}

View Market Depth
    [Documentation]    Navigates to market depth view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Trading}
    Click To Element    ${btnMenu_Trading_MarketDepth}

View Course Of Sales
    [Documentation]    Navigates to course of sales view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Trading}
    Click To Element    ${btnMenu_Trading_CourseOfSales}

View Security Details
    [Documentation]    Navigates to security details view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Trading}
    Click To Element    ${btnMenu_Trading_SecurityDetails}

View Watchlist
    [Documentation]    Navigates to watchlist view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Trading}
    Click To Element    ${btnMenu_Trading_Watchlist}

View Portfolio(Holding)
    [Documentation]    Navigates to portfolio holdings view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Portfolio}
    Click To Element    ${btnMenu_Portfolio_Holdings}

View Portfolio Summary
    [Documentation]    Navigates to portfolio summary view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Portfolio}
    Click To Element    ${btnMenu_Portfolio_Summary}

View Account Details
    [Documentation]    Navigates to account details view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_AccountDetails}

View Contract Notes
    [Documentation]    Navigates to contract notes view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_ContractNotes}

View Insights
    [Documentation]    Navigates to insights view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_Insights}

View Reports
    [Documentation]    Navigates to reports view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_Reports}

View Activities
    [Documentation]    Navigates to activities view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_Activities}

View User Info
    [Documentation]    Navigates to user info view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Account}
    Click To Element    ${btnMenu_Account_UserInfo}

View All Holding
    [Documentation]    Navigates to all holdings view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Operator}
    Click To Element    ${btnMenu_Operator_AllHoldings}

View All Orders
    [Documentation]    Navigates to all orders view
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_Operator}
    Click To Element    ${btnMenu_Operator_AllOrders}

# ===== Verification Keywords =====

Verify View Market Overview
    [Documentation]    Verifies market overview page content
    Page Should Contain    ASX S&P 20
    Page Should Contain    ASX S&P 50
    Page Should Contain    ASX S&P 100
    Page Should Contain    ASX S&P 200

Verify View Profile
    [Documentation]    Verifies company profile page content
    Page Should Contain    ANZ Group Holdings Limited
    Page Should Contain    ANZ Centre
    Page Should Contain    Australia
    Page Should Contain    https://www.anz.com.au
    Page Should Contain    Banks - Diversified
    Page Should Contain    Level 9 833 Collins Street Docklands

Verify View Fundamental Statistics
    [Documentation]    Verifies fundamental statistics page content
    Page Should Contain    Market Cap (intraday)
    Page Should Contain    Trailing P/E
    Page Should Contain    Forward P/E
    Page Should Contain    Price/Sales (ttm)
    Page Should Contain    Price/Book (mrq)
    Page Should Contain    Currency in AUD

Verify View Fundamental Analysis
    [Documentation]    Verifies fundamental analysis page content
    Page Should Contain    No. of Analysts
    Page Should Contain    Avg. Estimate
    Page Should Contain    Low Estimate
    Page Should Contain    High Estimate
    Page Should Contain    Year Ago EPS
    Page Should Contain    No. of Analysts

Verify View Major Holder
    [Documentation]    Verifies major holders page content
    Page Should Contain    % of Shares Held by All Insider
    Page Should Contain    % of Shares Held by Institutions
    Page Should Contain    % of Float Held by Institutions
    Page Should Contain    Number of Institutions Holding Shares
    Page Should Contain    Top Mutual Fund Holders
    Page Should Contain    Top Institutional Holders

Verify View Insider Roster
    [Documentation]    Verifies insider roster page content
    Page Should Contain    Insider Roster
    Page Should Contain    Name
    Page Should Contain    Title
    Page Should Contain    Pay
    Page Should Contain    Exercised
    Page Should Contain    Year Born

Verify View Insider Transactions
    [Documentation]    Verifies insider transactions page content
    Page Should Contain    Purchases
    Page Should Contain    Sales
    Page Should Contain    Net Shares Purchased (Sold)
    Page Should Contain    Total Insider Shares Held
    Page Should Contain    % Net Shares Purchased (Sold)
    Page Should Contain    % Change in Institutional Shares Held

Verify View Chart
    [Documentation]    Verifies chart view content
    Page Should Contain Element    ${canvas}
    Page Should Contain Element    ${indicator}
    Page Should Contain Element    ${aroon}

Verify View Derivatives
    [Documentation]    Verifies derivatives view content
    Page Should Contain    Derivatives
    Page Should Contain    Options
    Page Should Contain    Warrants
    Page Should Contain    Futures

Verify View Market News
    [Documentation]    Verifies market news view content
    Page Should Contain    Market News
    Page Should Contain    Latest News
    Page Should Contain    Related News

Verify View Market Depth
    [Documentation]    Verifies market depth view content
    Page Should Contain    Market Depth
    Page Should Contain    Bid
    Page Should Contain    Ask
    Page Should Contain    Volume

Verify View Course Of Sales
    [Documentation]    Verifies course of sales view content
    Page Should Contain    Course of Sales
    Page Should Contain    Time
    Page Should Contain    Price
    Page Should Contain    Volume

Verify View Security Details
    [Documentation]    Verifies security details view content
    Page Should Contain    Security Details
    Page Should Contain    Symbol
    Page Should Contain    Description
    Page Should Contain    Exchange

Verify View Portfolio Holdings
    [Documentation]    Verifies portfolio holdings view content
    Page Should Contain    Portfolio Holdings
    Page Should Contain    Symbol
    Page Should Contain    Quantity
    Page Should Contain    Market Value

Verify View Portfolio Summary
    [Documentation]    Verifies portfolio summary view content
    Page Should Contain    Portfolio Summary
    Page Should Contain    Total Value
    Page Should Contain    Cash Balance
    Page Should Contain    Available Funds

Verify View Account Details
    [Documentation]    Verifies account details view content
    Page Should Contain    Account Details
    Page Should Contain    Account Number
    Page Should Contain    Account Type
    Page Should Contain    Status

Verify View Contract Notes
    [Documentation]    Verifies contract notes view content
    Page Should Contain    Contract Notes
    Page Should Contain    Date
    Page Should Contain    Reference
    Page Should Contain    Description

Verify View Reports
    [Documentation]    Verifies reports view content
    Page Should Contain    Reports
    Page Should Contain    Statement
    Page Should Contain    Tax Report
    Page Should Contain    Activity Report

Verify View Activities
    [Documentation]    Verifies activities view content
    Page Should Contain    Activities
    Page Should Contain    Date
    Page Should Contain    Type
    Page Should Contain    Description

Verify View User Info
    [Documentation]    Verifies user info view content
    Page Should Contain    User Information
    Page Should Contain    Name
    Page Should Contain    Email
    Page Should Contain    Phone

Verify View All Holdings
    [Documentation]    Verifies all holdings view content
    Page Should Contain    All Holdings
    Page Should Contain    Account
    Page Should Contain    Symbol
    Page Should Contain    Quantity

Verify View All Orders
    [Documentation]    Verifies all orders view content
    Page Should Contain    All Orders
    Page Should Contain    Order ID
    Page Should Contain    Symbol
    Page Should Contain    Status

# ===== Alert Management Keywords =====

Create Alert
    [Documentation]    Creates a new price alert
    Click To Element    ${btnCreateAlert}
    Input Text To Element    ${searchCode}    BHP.ASX
    Click To Element    ${itemSuggest}
    Click To Element    ${btnConfirm}

Verify Create Alert
    [Documentation]    Verifies alert creation success
    Page Should Contain    Create new alert successfully

Edit Alert
    [Documentation]    Edits an existing price alert
    Click Element At Coordinates    ${btnCreateAlert}    5    80
    Input Text To Element    ${targetValue}    1
    Click To Element    ${btnConfirm}

Verify Edit Alert
    [Documentation]    Verifies alert edit success
    Page Should Not Contain    Modifying alert successfully

Delete Alert
    [Documentation]    Deletes an existing price alert
    Click Element At Coordinates    ${btnCreateAlert}    15    80
    Click To Element    ${btnOk}

Verify Delete Alert
    [Documentation]    Verifies alert deletion success
    Page Should Contain    Alert deleted successfully

Active Alert
    [Documentation]    Activates a price alert
    Click Element At Coordinates    ${btnCreateAlert}    2380    80

Verify Active Alert
    [Documentation]    Verifies alert activation success
    Page Should Contain    Alert activated successfully

View Market News relatedNews
    Mouse Over    ${btnMenu}
    Mouse Over    ${btnMenu_MarketAnalysis}
    Click To Element    ${btnMenu_MarketAnalysis_News}
    Click To Element    ${relatedNews}
